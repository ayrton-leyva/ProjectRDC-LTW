<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- jQuery first then Bootstrap JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="css/mdb.min.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/mystyles.css">
  <title>LOR</title>
</head>

<body>

  <nav class="navbar navbar-expand-sm navbar-light bg-light fix">

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-center align-items-center" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item active badge">
          <!--<a class="nav-link" href="fruitPie.html"><img src="./images/method-draw-image.svg" alt="RPP"></a>-->
          <a class="nav-link" href="index.html"><span class="full-text">Homepage</span><span
              class="short-text">RPP</span></a>
        </li>
        <li class="nav-item dropdown badge">
          <a class="nav-link dropdown-toggle" href="LOL.html" id="navbarDropdownMenuLink" role="button"
            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="full-text">League Of Legends</span><span class="short-text">LOL</span>
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item" href="LOL.html">Player review</a>
            <a class="dropdown-item" href="LOL_LeaderboardCH.html">Leaderboard</a>
          </div>
        </li>
        <li class="nav-item badge">
          <a class="nav-link" href="LOR.html"><span class="full-text">Legends Of Runeterra</span><span
              class="short-text">LOR</span></a>
        </li>
        <li class="nav-item dropdown badge">
          <a class="nav-link dropdown-toggle" href="TFT.html" id="navbarDropdownMenuLink" role="button"
            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="full-text">TeamFight Tactics</span><span class="short-text">TFT</span>
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item" href="TFT.html">Player review</a>
            <a class="dropdown-item" href="TFT_LeaderBoardCH.html">Leaderboard</a>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <main style="background-color: rgb(14, 4, 14);">
    <div class="bg-image d-flex justify-content-center align-items-center" style="
    background-image: url('./images/teamfight-tactics-82652.jpg');
    background-repeat: no-repeat;
    height:40vh;
    background-position:center;
    ">
      <div class="mask" style=" background-color:rgba(0,0,0,0.6)">
        <div class="d-flex justify-content-center align-items-center h-100">


          <!-- Navbar -->
          <nav class="navbar navbar-expand-lg navbar-dark riquadro">
            <!-- Container wrapper -->
            <div class="container-fluid">

              <!-- Collapsible wrapper -->
              <div class="w-auto">

                <!-- Dropdown -->
                <select id="regionSelector" name="region" class="custom-select my-1 mr-sm-2" id="RegionSelector"
                  style="background-color: #160220; color: white;">
                  <option value="euw1">EUW1</option>
                  <option value="br1">BR1</option>
                  <option value="eun1">EUN1</option>
                  <option value="jp1">JP1</option>
                  <option value="kr">KR</option>
                  <option value="la1">LA1</option>
                  <option value="la2">LA2</option>
                  <option value="na1">NA1</option>
                  <option value="oc1">OC1</option>
                  <option value="ru">RU</option>
                  <option value="tr1">TR1</option>
                </select>

                <!-- Search -->

                <input type="search" spellcheck="false" id="summonerName" name="summoner" class="form-control"
                  placeholder="Summoner name" aria-label="Search" style="background-color: #160220; color: white;">

                <div class=" buttonForm">
                  <button type="button" id="btn-submit" class=" btn btn-light btn-primary" data-mdb-ripple-color="dark"
                    style="background-color: #160220; color: white;">Search</button>
                </div>
              </div>

            </div>
        </div>
        <!-- Container wrapper -->
        </nav>
        <!-- Navbar -->

      </div>
    </div>


    <!--fine maschera-->
    <!-- stampa-->
    <div class="container" style="padding-top: 50px; color: white;">
      <div id="rowLeague" class="row">
        <div id="summ" class="col-12 col-md-6 col-sm-6 center_box">
        </div>
        <div id="favourite" class="col-12 col-md-6 col-sm-6 center_box">
        </div>
      </div>
    </div>

    <div class="container" style="padding-top: 50px; color: white;">
      <div id="grafici" class="row">
        <div id="grafWin" class="col-12 col-md-6 col-sm-12 center_box">
        </div>
        <div id="grafLoss" class="col-12 col-md-6 col-sm-12 center_box">
        </div>
      </div>
    </div>



    <div class="container" style="padding-top: 50px;">
      <div id="row0" class="row" style="color: white;">
        <div id="col00" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col01" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col02" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col03" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
      </div>

      <div id="row1" class="row" style="color:white;">
        <div id="col10" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col11" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col12" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col13" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
      </div>


      <div id="row2" class="row" style="color: white;">
        <div id="col20" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col21" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col22" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col23" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
      </div>

      <div id="row3" class="row" style="color: white;">
        <div id="col30" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col31" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col32" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col33" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
      </div>

      <div id="row4" class="row" style="color: white;">
        <div id="col40" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col41" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col42" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
        <div id="col43" class="col-3 col-md-3 col-sm-3 center_box">
        </div>
      </div>
    </div>
    </div>

    <!-- fine stampa-->


  </main>








  <footer>
    <div class="container mt-4 pt-3">
      <div class="row">
        <div class="col-6 col-md-6 col-xl-3">
          <h2>Project</h2>
          <ul>
            <li>LTW</li>
            <li>RDC</li>
          </ul>
        </div> <!-- end column -->
        <div class="col-6 col-md-6 col-xl-3">
          <h2>Functions</h2>
          <ul>
            <li>Match list</li>
            <li>Leaderboard</li>
          </ul>
        </div> <!-- end column -->
        <div class="col-6 col-md-6 col-xl-3">
          <h2>Students</h2>
          <ul>
            <li>Riccardo Puccetti</li>
            <li>Ayrton Leyva Saldana</li>
          </ul>
        </div> <!-- end column -->
        <div class="col-6 col-md-6 col-xl-3">
          <h2>About Us</h2>
          <img src="./images/method-draw-image.svg" alt="logo">
        </div> <!-- end column -->
      </div><!-- end row -->
  </footer>


</body>








<script>
  $(document).ready(function () {
    $("#btn-submit").click(function () {
      var player = document.getElementById("summonerName").value;
      if (player == '') alert("Empty summoner name doesn't exists");
      else {
        $.post('http://localhost:8888/LOR.html/Data?summoner=' + player + "&region=" + $("#regionSelector").val(), function (result) {
          if (Object.keys(result).length == 1) {
            if (JSON.stringify(result.status).includes("404")) { alert("Player not found"); }
            else if (JSON.stringify(result.status).includes("422")) { alert("Summoner didn't play enough matches"); }
            else if (JSON.stringify(result.status).includes("204")) { alert("Summoner didn't play last season"); }
          }

          else {
            $("#rowLeague").addClass("riquadro_league");
            $("#rowLeague").css("textShadow", "0 0 10px #000000, 0 0 5px #000000, 0 0 5px #000000");

            //inserisce dati nei vari spazi
            $("#summ").html("<div><h5>" + result[0].name + "</h5><p>LV: " + result[0].summonerlevel + "</p></div>");

            //insert favourite factions
            if (result[5][0].faction != 'undefined' && result[5][1].faction != 'undefined')
              $("#favourite").html("<div><h5>Favourite factions</h5><p><img src='./images/loghi/" + result[5][0].faction + ".svg' style='height: 30px; width: 30px;' alt='" + result[5][0].faction + "'><img src='./images/loghi/" + result[5][1].faction + ".svg' style='height: 30px; width: 30px;' alt='" + result[5][1].faction + "'></p></div>");
            else if (result[5][0].faction == 'undefined' && result[5][1].faction != 'undefined')
              $("#favourite").html("<div><h5>Favourite factions</h5><p>CUSTOM  <img src='./images/loghi/" + result[5][1].faction + ".svg' style='height: 30px; width: 30px;' alt='" + result[5][1].faction + "'></p></div>");
            else if (result[5][0].faction != 'undefined' && result[5][1].faction == 'undefined')
              $("#favourite").html("<div><h5>Favourite factions</h5><p><img src='./images/loghi/" + result[5][0].faction + ".svg' style='height: 30px; width: 30px;' alt='" + result[5][0].faction + "'>  CUSTOM</p></div>");


            //wins chart
            $("#grafWin").addClass("riquadro_league");
            $("#grafWin").html('<canvas id="gwin"></canvas>');


            let arr = [], ind = [];
            for (let x = 0; x < Object.keys(result[3]).length; x++) {
              arr.push(result[3][x].sum);
              if (result[3][x].faction == 'undefined') ind.push('Custom')
              else ind.push((result[3][x].faction).replaceAll('faction_', '').replaceAll('_Name', ''));
            }

            var ctx = document.getElementById('gwin');
            new Chart(ctx, {
              type: 'bar',
              data: {
                labels: ind,
                datasets: [{
                  label: 'Wins',
                  data: arr,
                  fill: false,
                  tension: 0.1,
                  backgroundColor: '#0000ff'
                }],
              },
              options: {
                legend: {
                  labels: {
                    fontColor: 'white'
                  }
                },
                scales: {
                  yAxes: [{
                    ticks: {
                      beginAtZero: true,
                      fontColor: 'white'
                    }
                  }],
                  xAxes: [{
                    ticks: {
                      fontColor: 'white'
                    }
                  }]
                }
              },
            });


            //losses chart
            $("#grafLoss").addClass("riquadro_league");
            $("#grafLoss").html('<canvas id="gloss"></canvas>');


            arr = [], ind = [];
            for (let x = 0; x < Object.keys(result[4]).length; x++) {
              arr.push(result[4][x].sum);
              if (result[4][x].faction == 'undefined') ind.push('Custom')
              else ind.push((result[4][x].faction).replaceAll('faction_', '').replaceAll('_Name', ''));
            }

            var ctx = document.getElementById('gloss');
            new Chart(ctx, {
              type: 'bar',
              data: {
                labels: ind,
                datasets: [{
                  label: 'Losses',
                  data: arr,
                  fill: false,
                  tension: 0.1,
                  backgroundColor: '#ff0000'
                }],
              },
              options: {
                legend: {
                  labels: {
                    fontColor: 'white'
                  }
                },
                scales: {
                  yAxes: [{
                    ticks: {
                      beginAtZero: true,
                      fontColor: 'white'
                    }
                  }],
                  xAxes: [{
                    ticks: {
                      fontColor: 'white'
                    }
                  }]
                }
              },
            });




            //print table##########################################à
            for (var i = 0, j = 4; i < 5; i++, j--) {
              var row = document.getElementById("row" + i)
              $("#row" + i).css("textShadow", "0 0 10px #000000, 0 0 5px #000000, 0 0 5px #000000")
              $("#row" + i).addClass("match");


              var colA2 = document.getElementById("col" + i + "2");
              var colA3 = document.getElementById("col" + i + "3");


              if (result[1][i].game_outcome == 'win') {
                outcome = "WIN";
                $("#col" + i + "0").html("<div><p style='color:#0000ff;'>" + outcome + "</p></div>");
                document.getElementById("row" + i).classList.remove('outcome_lose');
                document.getElementById("row" + i).classList.add('outcome_win');
              }
              else {
                outcome = "LOSS";
                $("#col" + i + "0").html("<div><p style='color:#ff0000;'>" + outcome + "</p></div>");
                document.getElementById("row" + i).classList.remove('outcome_win');
                document.getElementById("row" + i).classList.add('outcome_lose');
              }

              let order = "first";
              if (result[1][i].order_of_play == 2) order = "second";
              if (result[2][j].game_type == '') $("#col" + i + "1").html("<div><p>CUSTOM</p><p>Played " + order + "</p></div>");
              else $("#col" + i + "1").html("<div><p>" + result[2][j].game_type.toUpperCase() + "</p><p>Played " + order + "</p></div>");

              let faction1 = result[1][i].factions_1.replaceAll('faction_', '');
              faction1 = faction1.replaceAll('_Name', '');
              let faction2 = result[1][i].faction_2.replaceAll('faction_', '');
              faction2 = faction2.replaceAll('_Name', '');
              if (result[1][i].factions_1 != 'undefined' && result[1][i].faction_2 != 'undefined')
              $("#col" + i + "2").html("<div><p>Factions: <img src='./images/loghi/" + result[1][i].factions_1 + ".svg' style='height: 30px; width: 30px;' alt='" + faction1 + "'><img src='./images/loghi/" + result[1][i].faction_2 + ".svg' style='height: 30px; width: 30px;' alt='" + faction2 + "'></p></div>");
              else if (result[1][i].factions_1 != 'undefined' && result[1][i].faction_2 == 'undefined')
              $("#col" + i + "2").html("<div><p>Factions: <img src='./images/loghi/" + result[1][i].factions_1 + ".svg' style='height: 30px; width: 30px;' alt='" + faction1 + "'></p></div>");
              else if (result[1][i].factions_1 == 'undefined' && result[1][i].faction_2 != 'undefined')
              $("#col" + i + "2").html("<div><p>Factions: <img src='./images/loghi/" + result[1][i].faction_2 + ".svg' style='height: 30px; width: 30px;' alt='" + faction2 + "'></p></div>");
              else $("#col" + i + "2").html("<div><p>Custom</p></div>");

              if (result[1][i].deck_code == '') $("#col" + i + "3").html("<div><p>Tutorial deck</p></div>");
              else {
                $("#col" + i + "3").html("<div><button id='" + i + "' onClick='deck_click(this.id)' value='" + result[1][i].deck_code + "'>Copy deck</button></div>");
                $("#"+i.toString()).addClass("btn_copy");
              }
            }
          }
        });
      }
    });
  });
</script>

<script type="text/javascript">
  function deck_click(clicked_id) {
    var input = document.createElement('input');
    input.value = document.getElementById(clicked_id).value;
    input.id = 'inputID';
    document.body.appendChild(input);
    input.select();
    document.execCommand('copy');
    document.body.removeChild(input);
    alert("Deck code copied to clipboard");
  }
</script>




</html>